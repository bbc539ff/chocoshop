<!DOCTYPE html>
<html>

   <head>
      <meta charset="UTF-8">
      <title></title>
      <link rel="stylesheet" type="text/css" href="/css/easyui.css">
      <link rel="stylesheet" type="text/css" href="/css/icon.css">
      <script type="text/javascript" src="/js/jquery.min.js"></script>
      <script type="text/javascript" src="/js/jquery.easyui.min.js"></script>
      <script type="text/javascript" src="/js/jquery.form.min.js"></script>
   </head>

   <body>

      <table id="dg" title="Custom DataGrid Pager" data-options="rownumbers:true,singleSelect:true,pagination:true,url:'/admin/admin-list',method:'get'">
         <thead>
            <tr>
               <th field="adminId">ID</th>
               <th field="adminName">管理员名</th>
               <th field="adminNickname">昵称</th>
               <th field="adminState">状态</th>
               <th field="adminPhone">联系电话</th>
               <th field="adminEmail">电子邮箱</th>
               <th field="adminCreateTime">注册时间</th>
               <th field="adminUpdateTime">更新时间</th>
               <th field="adminGender">性别</th>
               <th field="adminAddress">地址</th>
            </tr>
         </thead>
      </table>
      <div id="addWin" class="easyui-window" title="Login" closed="true" style="width:300px;height:400px;">
         <form id="formAddEdit" method="post">
            <table>
               <tr>
                  <td><span>ID: </span></td>
                  <td><input class="textbox" name="adminId" style="display: none;"></td>
               </tr>
               <tr>
                  <td><span>管理员名: </span></td>
                  <td><input class="textbox" name="adminName"></td>
               </tr>
               <tr>
                  <td><span>昵称: </span></td>
                  <td><input class="textbox" name="adminNickname"></td>
               </tr>
               <tr>
                  <td><span>密码: </span></td>
                  <td><input class="textbox" name="adminPassword"></td>
               </tr>
               <tr>
                  <td><span>用户状态: </span></td>
                  <td>
                     <input type="radio" name="adminState" value="0"><span>女</span><br/>
                     <input type="radio" name="adminState" value="1"><span>男</span><br/>
                  </td>
               </tr>
               <tr>
                  <td><span>联系电话: </span></td>
                  <td><input class="textbox" name="adminPhone" data-options="validType:'length[11]'"></td>
               </tr>
               <tr>
                  <td><span>电子邮箱: </span></td>
                  <td><input class="easyui-validatebox textbox" data-options="validType:'email'" name="adminEmail"></td>
               </tr>
               <tr>
                  <td><span>注册时间: </span></td>
                  <td>
                     <input class="easyui-datetimebox" id="adminCreateTime" name="adminCreateTime" data-options="required:true,showSeconds:true" style="width:150px">
               </tr>
               <tr>
                  <td><span>更新时间: </span></td>
                  <td><input class="easyui-datetimebox" id="adminUpdateTime" name="adminUpdateTime" data-options="required:true,showSeconds:true" style="width:150px"></td>
               </tr>
               <tr>
                  <td><span>性别: </span></td>
                  <td>
                     <input type="radio" name="adminGender" value="0"><span>女</span><br/>
                     <input type="radio" name="adminGender" value="1"><span>男</span><br/>
                  </td>
               </tr>
               <tr>
                  <td><span>地址: </span></td>
                  <td><input class="textbox" name="adminAddress"></td>
               </tr>
            </table>
            <div style="padding:5px;text-align:center;">
               <a id="aSmt" class="easyui-linkbutton" icon="icon-ok">Ok</a>
               <a href="#" class="easyui-linkbutton" icon="icon-cancel" onclick="$('#addWin').window('close');">Cancel</a>
            </div>
         </form>
      </div>

      </div>
      <script type="text/javascript">
         $(function() {
            var pager = $('#dg').datagrid().datagrid('getPager'); // get the pager of datagrid
            pager.pagination({
               buttons: [{
                  iconCls: 'icon-search',
                  handler: function() {
                     alert('search');
                  }
               }, {
                  iconCls: 'icon-add',
                  handler: function() {
                     $('#aSmt').attr("onclick", "add()")
                     $('#addWin').window('open');
                  }
               }, {
                  iconCls: 'icon-edit',
                  handler: function() {
                     var row = $('#dg').datagrid('getSelected');
                     if(row) {
                        $('#aSmt').attr("onclick", "edit()")

                        $('input[name=adminId]').val(row.adminId)
                        $('input[name=adminName]').val(row.adminName)
                        $('input[name=adminNickname]').val(row.adminNickname)
                        $('input[name=adminPassword]').val(row.adminPassword)
                        $('input[name=adminState]:checked').val(row.adminState)
                        $('input[name=adminPhone]').val(row.adminPhone)
                        $('input[name=adminEmail]').val(row.adminEmail)
                        $('#adminCreateTime').datetimebox('setValue', parseDate(new Date(row.adminCreateTime)))
                        $('#adminUpdateTime').datetimebox('setValue', parseDate(new Date(row.adminUpdateTime)))
                        $('input[name=adminGender]:checked').val(row.adminGender)
                        $('input[name=adminAddress]').val(row.adminAddress)

                        $('#addWin').window('open');
                     } else {
                        $.messager.alert('Warning', '请先选择！');
                     }

                  }
               }, {
                  iconCls: 'icon-remove',
                  handler: function() {
                     var row = $('#dg').datagrid('getSelected');
                     if(row) {
                        $.ajax("/admin/delete?adminId=" + row.adminId, {
                           success: function() {
                              $.messager.alert('Warning', '删除成功！');
                           },
                           error: function() {
                              $.messager.alert('Warning', '删除失败！');
                           }
                        })
                     } else {
                        $.messager.alert('Warning', '请先选择！');
                     }
                  }
               }]
            });

         })

         function add() {
            var form = $("#formAddEdit")
            var options = {
               url: '/admin/add',
               type: 'post',
               success: function(data) { //成功执行的方法
                  if("success" == data) {
                     $.messager.alert('Warning', '添加成功！');
                     $('#addWin').window('close');
                  } else {
                     $.messager.alert('Warning', '添加失败！');
                     $('#addWin').window('close');
                  }
               },
               error: function(data) {
                  if("error" == data) {
                     $.messager.alert('Warning', '添加失败！');
                     $('#addWin').window('close');
                  }
               }
            }
            form.ajaxSubmit(options)
         }

         function edit() {
            var form = $("#formAddEdit")
            var options = {
               url: '/admin/update',
               type: 'post',
               success: function(data) { //成功执行的方法
                  if("success" == data) {
                     $.messager.alert('Warning', '修改成功！');
                     $('#addWin').window('close');
                  } else {
                     $.messager.alert('Warning', '修改失败！');
                     $('#addWin').window('close');
                  }
               },
               error: function(data) {
                  if("error" == data) {
                     $.messager.alert('Warning', '修改失败！');
                     $('#addWin').window('close');
                  }
               }
            }
            form.ajaxSubmit(options)
         }

         function parseDate(value) {
            var date = new Date(value);
            var year = date.getFullYear();
            var month = date.getMonth() + 1; //月份+1   
            var day = date.getDate();
            var hour = date.getHours();
            var minutes = date.getMinutes();
            var second = date.getSeconds();
            return day + "/" + month + "/" + year + " " + hour + ":" + minutes + ":" + second;
         }
      </script>

   </body>

</html>